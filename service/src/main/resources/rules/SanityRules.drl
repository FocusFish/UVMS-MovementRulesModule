import eu.europa.ec.fisheries.uvms.rules.service.business.ErrorEvent;
import eu.europa.ec.fisheries.uvms.rules.service.business.RawFact;
import eu.europa.ec.fisheries.uvms.rules.service.business.RulesUtil;
import java.util.Date;
global eu.europa.ec.fisheries.uvms.rules.service.RulesService rulesService;


rule "Sanity check - Latitude must exist"
dialect "java"
    when
        $fact : RawFact(movementBaseType.position.latitude == null)
    then
        System.out.println("DEBUG - Sanity check - Latitude must exist");
        $fact.setOk(false);
        insert(new ErrorEvent("Sanity check - Latitude must exist", $fact));
end

rule "Sanity check - Longitude must exist"
dialect "java"
    when
        $fact : RawFact(movementBaseType.position.longitude == null)
    then
        System.out.println("DEBUG - Sanity check - Longitude must exist");
        $fact.setOk(false);
        insert(new ErrorEvent("Sanity check - Latitude must exist", $fact));
end


rule "Create an alarm report"
dialect "java"
    when
        $e : ErrorEvent($ruleName : ruleName, $rawFact : rawFact)
    then
        System.out.println("DEBUG - Create an alarm for movement guid: " + $rawFact.getMovementBaseType().getGuid());
        rulesService.createAlarmReport($ruleName, $rawFact);
end

